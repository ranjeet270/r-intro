<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Simple Linear Regression | Introduction to R, version 2</title>
  <meta name="description" content="7 Simple Linear Regression | Introduction to R, version 2" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Simple Linear Regression | Introduction to R, version 2" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Simple Linear Regression | Introduction to R, version 2" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="next-steps.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#index">Introduction<span></span></a></li>
<li class="chapter" data-level="1" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html"><i class="fa fa-check"></i><b>1</b> Starting out in R<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#variables"><i class="fa fa-check"></i><b>1.1</b> Variables<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#saving-code-in-an-r-script"><i class="fa fa-check"></i><b>1.2</b> Saving code in an R script<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#vectors"><i class="fa fa-check"></i><b>1.3</b> Vectors<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#types-of-vector"><i class="fa fa-check"></i><b>1.4</b> Types of vector<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#indexing-vectors"><i class="fa fa-check"></i><b>1.5</b> Indexing vectors<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#sequences"><i class="fa fa-check"></i><b>1.6</b> Sequences<span></span></a></li>
<li class="chapter" data-level="1.7" data-path="starting-out-in-r.html"><a href="starting-out-in-r.html#functions"><i class="fa fa-check"></i><b>1.7</b> Functions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>2</b> Data frames<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-frames.html"><a href="data-frames.html#setting-up"><i class="fa fa-check"></i><b>2.1</b> Setting up<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="data-frames.html"><a href="data-frames.html#loading-data"><i class="fa fa-check"></i><b>2.2</b> Loading data<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="data-frames.html"><a href="data-frames.html#exploring"><i class="fa fa-check"></i><b>2.3</b> Exploring<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="data-frames.html"><a href="data-frames.html#indexing-data-frames"><i class="fa fa-check"></i><b>2.4</b> Indexing data frames<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="data-frames.html"><a href="data-frames.html#columns-are-vectors"><i class="fa fa-check"></i><b>2.5</b> Columns are vectors<span></span></a></li>
<li class="chapter" data-level="2.6" data-path="data-frames.html"><a href="data-frames.html#logical-indexing"><i class="fa fa-check"></i><b>2.6</b> Logical indexing<span></span></a></li>
<li class="chapter" data-level="2.7" data-path="data-frames.html"><a href="data-frames.html#factors"><i class="fa fa-check"></i><b>2.7</b> Factors<span></span></a></li>
<li class="chapter" data-level="2.8" data-path="data-frames.html"><a href="data-frames.html#readability-vs-tidyness"><i class="fa fa-check"></i><b>2.8</b> Readability vs tidyness<span></span></a></li>
<li class="chapter" data-level="2.9" data-path="data-frames.html"><a href="data-frames.html#sorting"><i class="fa fa-check"></i><b>2.9</b> Sorting<span></span></a></li>
<li class="chapter" data-level="2.10" data-path="data-frames.html"><a href="data-frames.html#joining-data-frames"><i class="fa fa-check"></i><b>2.10</b> Joining data frames<span></span></a></li>
<li class="chapter" data-level="2.11" data-path="data-frames.html"><a href="data-frames.html#further-reading"><i class="fa fa-check"></i><b>2.11</b> Further reading<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html"><i class="fa fa-check"></i><b>3</b> Plotting with ggplot2<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#elements-of-a-ggplot"><i class="fa fa-check"></i><b>3.1</b> Elements of a ggplot<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#further-geoms"><i class="fa fa-check"></i><b>3.2</b> Further geoms<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#highlighting-subsets"><i class="fa fa-check"></i><b>3.3</b> Highlighting subsets<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#fine-tuning-a-plot"><i class="fa fa-check"></i><b>3.4</b> Fine-tuning a plot<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#faceting"><i class="fa fa-check"></i><b>3.5</b> Faceting<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="plotting-with-ggplot2.html"><a href="plotting-with-ggplot2.html#saving-ggplots"><i class="fa fa-check"></i><b>3.6</b> Saving ggplots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing data<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#summary-functions"><i class="fa fa-check"></i><b>4.1</b> Summary functions<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#missing-values"><i class="fa fa-check"></i><b>4.2</b> Missing values<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="summarizing-data.html"><a href="summarizing-data.html#grouped-summaries"><i class="fa fa-check"></i><b>4.3</b> Grouped summaries<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="summarizing-data.html"><a href="summarizing-data.html#t-test"><i class="fa fa-check"></i><b>4.4</b> t-test<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="thinking-in-r.html"><a href="thinking-in-r.html"><i class="fa fa-check"></i><b>5</b> Thinking in R<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="thinking-in-r.html"><a href="thinking-in-r.html#lists"><i class="fa fa-check"></i><b>5.1</b> Lists<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="thinking-in-r.html"><a href="thinking-in-r.html#other-types-not-covered-here"><i class="fa fa-check"></i><b>5.2</b> Other types not covered here<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="thinking-in-r.html"><a href="thinking-in-r.html#programming"><i class="fa fa-check"></i><b>5.3</b> Programming<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>6</b> Next steps<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="next-steps.html"><a href="next-steps.html#deepen-your-understanding"><i class="fa fa-check"></i><b>6.1</b> Deepen your understanding<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="next-steps.html"><a href="next-steps.html#expand-your-vocabulary"><i class="fa fa-check"></i><b>6.2</b> Expand your vocabulary<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="next-steps.html"><a href="next-steps.html#join-the-community"><i class="fa fa-check"></i><b>6.3</b> Join the community<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>7</b> Simple Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#example-problem"><i class="fa fa-check"></i><b>7.1</b> Example Problem<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#graphical-analysis"><i class="fa fa-check"></i><b>7.2</b> Graphical Analysis<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#correlation-analysis"><i class="fa fa-check"></i><b>7.3</b> Correlation Analysis<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#building-the-linear-regression-model"><i class="fa fa-check"></i><b>7.4</b> Building the Linear Regression Model<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#linear-regression-diagnostics"><i class="fa fa-check"></i><b>7.5</b> Linear Regression Diagnostics<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#predicting-linear-models"><i class="fa fa-check"></i><b>7.6</b> Predicting Linear Models<span></span></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R, version 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-linear-regression" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Simple Linear Regression<a href="simple-linear-regression.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Simple linear regression lives up to its name: it is a very straightforward approach for predicting a quantitative response Y on the basis of a single predictor variable X. It assumes that there is approximately a linear relationship between X and Y as:</p>
<p><span class="math display">\[ Y=\beta_0+ \beta_1X+\epsilon(1) \]</span></p>
<p>where:</p>
<p>Y dependent variable</p>
<p>X independent variable</p>
<p><span class="math inline">\(\beta_0\)</span> is the intercept</p>
<p><span class="math inline">\(\beta_1\)</span> is the coefficient (slope term) representing the linear relationship</p>
<p><span class="math inline">\(\epsilon\)</span>is a mean-zero random error term.</p>
<p>We have covered the basic concepts about linear regression. Besides these, you need to understand that linear regression is based on certain underlying assumptions that must be taken care especially when working with multiple Xs. Once you are familiar with that, the advanced regression models will show you around the various special cases where a different form of regression would be more suitable.</p>
<div id="example-problem" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Example Problem<a href="simple-linear-regression.html#example-problem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this analysis, we will use the cars dataset that comes with R by default.</p>
<p>cars is a standard built-in dataset, that makes it convenient to show linear regression in a simple and easy to understand fashion.</p>
<p>You can access this dataset by typing in cars in your R console.</p>
<p>You will find that it consists of 50 observations(rows) and 2 variables (columns) dist and speed. Lets print out the first six observations here.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="simple-linear-regression.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Cars dataset from the Library. Cars data is an inbuilt dataset in R</span></span>
<span id="cb218-2"><a href="simple-linear-regression.html#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb218-3"><a href="simple-linear-regression.html#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cars)</span>
<span id="cb218-4"><a href="simple-linear-regression.html#cb218-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-5"><a href="simple-linear-regression.html#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cars)  <span class="co"># display the first 6 observations</span></span></code></pre></div>
<p>The goal here is to establish a mathematical equation for dist as a function of speed, so you can use it to predict dist when only the speed of the car is known.</p>
<p>So it is desirable to build a linear regression model with the response variable as dist and the predictor as speed.</p>
<p>Before we begin building the regression model, it is a good practice to analyse and understand the variables.</p>
<p>The graphical analysis and correlation study below will help with this.</p>
</div>
<div id="graphical-analysis" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Graphical Analysis<a href="simple-linear-regression.html#graphical-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Scatter plot</li>
</ul>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="simple-linear-regression.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.6     ✓ dplyr   1.0.8
## ✓ tidyr   1.2.0     ✓ stringr 1.4.0
## ✓ readr   2.1.2     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="simple-linear-regression.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x=</span>speed,<span class="at">y=</span>dist))<span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;" /></p>
<ul>
<li>Boxplot</li>
</ul>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="simple-linear-regression.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb224-2"><a href="simple-linear-regression.html#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="simple-linear-regression.html#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot</span></span>
<span id="cb224-4"><a href="simple-linear-regression.html#cb224-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-5"><a href="simple-linear-regression.html#cb224-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">y=</span>speed))<span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Speed&quot;</span>)  <span class="co"># speed</span></span>
<span id="cb224-6"><a href="simple-linear-regression.html#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="simple-linear-regression.html#cb224-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">y=</span>dist))<span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Distance&quot;</span>) <span class="co"># Distance</span></span>
<span id="cb224-8"><a href="simple-linear-regression.html#cb224-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-9"><a href="simple-linear-regression.html#cb224-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-10"><a href="simple-linear-regression.html#cb224-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 </span></code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;" /></p>
<ul>
<li>Density plot</li>
</ul>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="simple-linear-regression.html#cb225-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x=</span>speed)) <span class="sc">+</span> </span>
<span id="cb225-2"><a href="simple-linear-regression.html#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb225-3"><a href="simple-linear-regression.html#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Speed&quot;</span>)  <span class="co"># speed</span></span>
<span id="cb225-4"><a href="simple-linear-regression.html#cb225-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-5"><a href="simple-linear-regression.html#cb225-5" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x=</span>dist))<span class="sc">+</span> </span>
<span id="cb225-6"><a href="simple-linear-regression.html#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb225-7"><a href="simple-linear-regression.html#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Distance&quot;</span>) <span class="co"># Distance</span></span>
<span id="cb225-8"><a href="simple-linear-regression.html#cb225-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-9"><a href="simple-linear-regression.html#cb225-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-10"><a href="simple-linear-regression.html#cb225-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="sc">+</span> p4 </span></code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="correlation-analysis" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Correlation Analysis<a href="simple-linear-regression.html#correlation-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Correlation analysis studies the strength of relationship between two continuous variables. It involves computing the correlation coefficient between the the two variables.</p>
<p>So what is correlation? And how is it helpful in linear regression?</p>
<p>Correlation is a statistical measure that shows the degree of linear dependence between two variables.</p>
<p>In order to compute correlation, the two variables must occur in pairs, just like what we have here with speed and dist.</p>
<p>Correlation can take values between -1 to +1.</p>
<p>If one variables consistently increases with increasing value of the other, then they have a strong positive correlation (value close to +1).</p>
<p>Similarly, if one consistently decreases when the other increase, they have a strong negative correlation (value close to -1).</p>
<p>A value closer to 0 suggests a weak relationship between the variables.</p>
<p>A low correlation (-0.2 &lt; x &lt; 0.2) probably suggests that much of variation of the response variable (Y) is unexplained by the predictor (X). In that case, you should probably look for better explanatory variables.</p>
<p>If you observe the cars dataset in the R console, for every instance where speed increases, the distance also increases along with it.</p>
<p>That means, there is a strong positive relationship between them. So, the correlation between them will be closer to 1.</p>
<p>However, correlation doesn’t imply causation.</p>
<p>In other words, if two variables have high correlation, it does not mean one variable ’causes’ the value of the other variable to increase.</p>
<p>Correlation is only an aid to understand the relationship. You can only rely on logic and business reasoning to make that judgement.</p>
<p>So, how to compute correlation in R?</p>
<p>Simply use the cor() function with the two numeric variables as arguments.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="simple-linear-regression.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cars<span class="sc">$</span>speed, cars<span class="sc">$</span>dist) <span class="co"># calculate correlation between speed and distance</span></span></code></pre></div>
<pre><code>## [1] 0.8068949</code></pre>
</div>
<div id="building-the-linear-regression-model" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Building the Linear Regression Model<a href="simple-linear-regression.html#building-the-linear-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that you have seen the linear relationship pictorially in the scatter plot and through correlation, let’s try building the linear regression model.</p>
<p>The function used for building linear models is lm().</p>
<p>The lm() function takes in two main arguments:</p>
<pre><code>-Formula
-Data</code></pre>
<p>The data is typically a data.frame object and the formula is a object of class formula.</p>
<p>But the most common convention is to write out the formula directly as written below.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="simple-linear-regression.html#cb229-1" aria-hidden="true" tabindex="-1"></a>linearMod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>cars)  <span class="co"># build linear regression model on full data</span></span>
<span id="cb229-2"><a href="simple-linear-regression.html#cb229-2" aria-hidden="true" tabindex="-1"></a>linearMod</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dist ~ speed, data = cars)
## 
## Coefficients:
## (Intercept)        speed  
##     -17.579        3.932</code></pre>
<p>By building the linear regression model, we have established the relationship between the predictor
and response “in” the form of a mathematical formula.</p>
<p>That is Distance (dist) as a “function for” speed.</p>
</div>
<div id="linear-regression-diagnostics" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Linear Regression Diagnostics<a href="simple-linear-regression.html#linear-regression-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now the linear model is built and you have a formula that you can use to predict the dist value if a corresponding speed is known.</p>
<p>Is this enough to actually use this model? NO!</p>
<p>Because, before using a regression model to make predictions, you need to ensure that it is statistically significant. But How do you ensure this?</p>
<p>Lets begin by printing the summary statistics for linearMod</p>
<pre><code>## 
## Call:
## lm(formula = dist ~ speed, data = cars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -29.069  -9.525  -2.272   9.215  43.201 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -17.5791     6.7584  -2.601   0.0123 *  
## speed         3.9324     0.4155   9.464 1.49e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.38 on 48 degrees of freedom
## Multiple R-squared:  0.6511, Adjusted R-squared:  0.6438 
## F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="simple-linear-regression.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># capture model summary as an object</span></span>
<span id="cb232-2"><a href="simple-linear-regression.html#cb232-2" aria-hidden="true" tabindex="-1"></a>modelSummary <span class="ot">&lt;-</span> <span class="fu">summary</span>(linearMod)  </span>
<span id="cb232-3"><a href="simple-linear-regression.html#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="simple-linear-regression.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(modelSummary)</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="simple-linear-regression.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(modelSummary)  </span></code></pre></div>
<pre><code>##  [1] &quot;call&quot;          &quot;terms&quot;         &quot;residuals&quot;     &quot;coefficients&quot; 
##  [5] &quot;aliased&quot;       &quot;sigma&quot;         &quot;df&quot;            &quot;r.squared&quot;    
##  [9] &quot;adj.r.squared&quot; &quot;fstatistic&quot;    &quot;cov.unscaled&quot;</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="simple-linear-regression.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model coefficients</span></span>
<span id="cb236-2"><a href="simple-linear-regression.html#cb236-2" aria-hidden="true" tabindex="-1"></a>modelCoeffs <span class="ot">&lt;-</span> modelSummary<span class="sc">$</span>coefficients  </span>
<span id="cb236-3"><a href="simple-linear-regression.html#cb236-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-4"><a href="simple-linear-regression.html#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get std.error for speed  </span></span>
<span id="cb236-5"><a href="simple-linear-regression.html#cb236-5" aria-hidden="true" tabindex="-1"></a>std.error <span class="ot">&lt;-</span> modelCoeffs[<span class="st">&quot;speed&quot;</span>, <span class="st">&quot;Std. Error&quot;</span>]</span>
<span id="cb236-6"><a href="simple-linear-regression.html#cb236-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-7"><a href="simple-linear-regression.html#cb236-7" aria-hidden="true" tabindex="-1"></a>modelSummary<span class="sc">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 15.37959</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="simple-linear-regression.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x=</span>speed,<span class="at">y=</span>dist))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb238-2"><a href="simple-linear-regression.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="linear_model_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="simple-linear-regression.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x=</span>speed,<span class="at">y=</span>dist))<span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb240-2"><a href="simple-linear-regression.html#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="linear_model_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="predicting-linear-models" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Predicting Linear Models<a href="simple-linear-regression.html#predicting-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far you have seen how to build a linear regression model using the whole dataset. If you build it that way, there is no way to tell how the model will perform with new data.</p>
<p>So the preferred practice is to split your dataset into a 80:20 sample (training:test), then, build the model on the 80% sample and then use the model thus built to predict the dependent variable on test data.</p>
<p>Doing it this way, we will have the model predicted values for the 20% data (test) as well as the actuals (from the original dataset).</p>
<p>By calculating accuracy measures (like min_max accuracy) and error rates (MAPE or MSE), you can find out the prediction accuracy of the model.</p>
<p>Now, lets see how to actually do this.</p>
<p><strong>Step 1: Create the training and test data</strong></p>
<p>This can be done using the sample() function. Just make sure you set the seed using set.seed() so the samples can be recreated for future use.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="simple-linear-regression.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Training and Test data -</span></span>
<span id="cb242-2"><a href="simple-linear-regression.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)  <span class="co"># setting seed to reproduce results of random sampling</span></span>
<span id="cb242-3"><a href="simple-linear-regression.html#cb242-3" aria-hidden="true" tabindex="-1"></a>trainingRowIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cars), <span class="fl">0.8</span><span class="sc">*</span><span class="fu">nrow</span>(cars))  <span class="co"># row indices for training data</span></span>
<span id="cb242-4"><a href="simple-linear-regression.html#cb242-4" aria-hidden="true" tabindex="-1"></a>trainingData <span class="ot">&lt;-</span> cars[trainingRowIndex, ]  <span class="co"># model training data</span></span>
<span id="cb242-5"><a href="simple-linear-regression.html#cb242-5" aria-hidden="true" tabindex="-1"></a>testData  <span class="ot">&lt;-</span> cars[<span class="sc">-</span>trainingRowIndex, ]   <span class="co"># test data</span></span></code></pre></div>
<p><strong>Step 2: Fit the model on training data and predict dist on test data</strong></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="simple-linear-regression.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the model on training data</span></span>
<span id="cb243-2"><a href="simple-linear-regression.html#cb243-2" aria-hidden="true" tabindex="-1"></a>lmMod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data=</span>trainingData)  <span class="co"># build the model</span></span>
<span id="cb243-3"><a href="simple-linear-regression.html#cb243-3" aria-hidden="true" tabindex="-1"></a>distPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmMod, testData)  <span class="co"># predict distance</span></span></code></pre></div>
<p><strong>Step 3: Review diagnostic measures</strong></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="simple-linear-regression.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (lmMod)  <span class="co"># model summary</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dist ~ speed, data = trainingData)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -24.726 -11.242  -2.564  10.436  40.565 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -20.1796     7.8254  -2.579   0.0139 *  
## speed         4.2582     0.4947   8.608 1.85e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 15.49 on 38 degrees of freedom
## Multiple R-squared:  0.661,  Adjusted R-squared:  0.6521 
## F-statistic: 74.11 on 1 and 38 DF,  p-value: 1.848e-10</code></pre>
<p>From the model summary, the model p value and predictors p value are less than the significance level.</p>
<p>So you have a statistically significant model.</p>
<p>Also, the R-Sq and Adj R-Sq are comparative to the original model built on full data.</p>
<p><strong>Step 4: Calculate prediction accuracy and error rates</strong></p>
<p>A simple correlation between the actuals and predicted values can be used as a form of accuracy measure.</p>
<p>A higher correlation accuracy implies that the actuals and predicted values have similar directional movement, i.e. when the actuals values increase the predicted values also increase and vice-versa.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="simple-linear-regression.html#cb246-1" aria-hidden="true" tabindex="-1"></a>original <span class="ot">&lt;-</span>  testData<span class="sc">$</span>dist</span>
<span id="cb246-2"><a href="simple-linear-regression.html#cb246-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> original<span class="sc">-</span>distPred</span>
<span id="cb246-3"><a href="simple-linear-regression.html#cb246-3" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">=</span> <span class="fu">mean</span>((d)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb246-4"><a href="simple-linear-regression.html#cb246-4" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(d))</span>
<span id="cb246-5"><a href="simple-linear-regression.html#cb246-5" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">=</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb246-6"><a href="simple-linear-regression.html#cb246-6" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">sum</span>((d)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>((original<span class="sc">-</span><span class="fu">mean</span>(original))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb246-7"><a href="simple-linear-regression.html#cb246-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-8"><a href="simple-linear-regression.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot; MAE:&quot;</span>, mae, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="st">&quot;MSE:&quot;</span>, mse, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, </span>
<span id="cb246-9"><a href="simple-linear-regression.html#cb246-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb246-10"><a href="simple-linear-regression.html#cb246-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;RMSE:&quot;</span>, rmse, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="st">&quot;R-squared:&quot;</span>, R2)</span></code></pre></div>
<pre><code>##  MAE: 12.50694 
##  MSE: 267.0002 
##  RMSE: 16.34014 
##  R-squared: 0.5142005</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="next-steps.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r-intro-2.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
